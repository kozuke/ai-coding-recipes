# Branch Strategy

このドキュメントでは、「AI Coding Recipes」プロジェクトにおけるブランチ運用方針をまとめます。  
GitHub 上での人間・AI（Devinなど）の共同開発を前提とし、明確な役割分担と管理のしやすさを重視します。

---

## 1. ブランチ構成の基本方針

| ブランチ名 | 役割 |
|------------|------|
| main       | 常に本番にデプロイ可能な状態を保つ |
| dev        | 開発の集約地点。機能追加や修正はここにマージされる |
| feature/*  | 個別機能の開発ブランチ。Devinまたは人間が作業 |

---

## 2. 開発フロー（通常）

1. main ブランチは常に安定版・デプロイ対象。
2. 開発は feature/xxxx ブランチで実施。
3. feature/* → dev に対して Pull Request を作成。
4. dev ブランチで統合・動作確認後、main にマージ。

---

## 3. Devinによる開発タスクの扱い

- Devinは feature/devin-xxx というブランチを作成して作業を行う。
- Devinの作業が完了したら Pull Request を作成。
- PRは原則レビューを経て dev にマージされる。
- Devinに対してもマージポリシーは統一する（直接 main に push しない）。

---

## 4. 命名規則（推奨）

| 種類       | 命名例                     |
|------------|----------------------------|
| 機能追加   | feature/tip-list-view      |
| バグ修正   | fix/search-not-working     |
| ドキュメント | docs/add-dev-flow        |
| Devin作業  | feature/devin-build-md     |

---

## 5. マージ戦略とルール

- PRベースでのマージを推奨（レビュー→マージ）
- main に直接 push することは原則禁止
- dev → main へのマージは下記条件で実施：
  - CI が通過している
  - 明示的な「リリースOK」判断がされている（人間の判断）
  - 実装仕様と実装結果の整合性確認済
  - マージ操作は GitHub 上で人間が実施（Pull Request または手動マージ）
  - 将来的には GitHub Actions による手動のデプロイトリガーも検討

---

## 6. デプロイとの関係性（Vercel）

- main へのマージをトリガーに本番環境へ自動デプロイ（Vercel）
- dev や feature/* はプレビューURLにて確認可能

---

## 7. 今後の運用改善について

- 状況に応じて GitHub Actions によるブランチ保護・ラベル自動付与などを検討
- Devinと人間の共同作業が増える場合、コミットメッセージフォーマットの統一も議論予定

---

この運用方針は Git Flow を簡略化したものであり、release/ や hotfix/ などのブランチは導入せず、スモールチーム・AI駆動開発に適した軽量構成としています。
